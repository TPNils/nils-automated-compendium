<div class="{{@root.staticValues.moduleName}}-item-card"
    data-actor-uuid="{{data.actor.uuid}}"
    {{#if token}}data-token-uuid="{{data.token.uuid}}"{{/if}}
  >

  {{#each data.items as |item itemIndex|}}
    <div data-{{@root.staticValues.moduleName}}-item-index="{{itemIndex}}">
      <div class="{{@root.staticValues.moduleName}}-header">
        <img src="{{item.img}}" title="{{item.name}}" width="36" height="36"/>
        <h3 class="{{@root.staticValues.moduleName}}-item-name">{{item.name}}</h3>
      </div>

      <div class="{{@root.staticValues.moduleName}}-section">
        {{#if item.description}}
          {{{item.description}}}
        {{/if}}
        {{#if item.materials}}
          <p><strong>{{ localize "DND5E.RequiredMaterials" }}.</strong> {{item.materials}}</p>
        {{/if}}
      </div>

      <div class="{{@root.staticValues.moduleName}}-section">
        {{#if item.attack}}
          {{#if item.attack.evaluatedRoll}}
            <div>
              {{> modules/nils-automated-compendium/templates/roll/roll.hbs flavor=item.attack.mode roll=item.attack.evaluatedRoll}}
            </div>
          {{else}}
            <div style="display: flex;">
              <button data-{{@root.staticValues.moduleName}}-action="item-attack">{{#if item.attack.label}}{{item.attack.label}}{{else}}{{localize "DND5E.Attack"}}{{/if}}</button>
              <button data-{{@root.staticValues.moduleName}}-action="item-attack-mode" style="color: {{#if (eq item.attack.mode 'disadvantage')}}red{{else if (eq item.attack.mode 'advantage')}}green{{/if}};">{{item.attack.mode}}</button>
            </div>
          {{/if}}
        {{/if}}
        
        {{#each item.damages as |dmg dmgIndex|}}
          {{#if dmg.roll.evaluated}}
            {{> modules/nils-automated-compendium/templates/roll/roll.hbs flavor=dmg.displayDamageTypes overrideFormula=dmg.displayFormula roll=dmg.roll}}
          {{else}}
            <button data-{{@root.staticValues.moduleName}}-action="item-damage-{{dmgIndex}}">{{#if dmg.label}}{{dmg.label}}{{else}}{{localize "DND5E.Damage"}}{{/if}}</button>
          {{/if}}
        {{/each}}
        
        {{#each item.checks as |check checkIndex|}}
          <button data-{{@root.staticValues.moduleName}}-action="item-check-{{checkIndex}}">
            {{#if check.label}}
            {{dmg.label}}
            {{else if check.save}}
            {{localize "DND5E.SavingThrow"}}
            {{else}}
            Ability check
            {{/if}}
          </button>
        {{/each}}

        {{#if item.template}}
          <button data-{{@root.staticValues.moduleName}}-action="item-template">{{ localize "DND5E.PlaceTemplate" }}</button>
        {{/if}}
      </div>

      <div class="{{@root.staticValues.moduleName}}-footer">
        {{#each item.properties}}
          <span>{{this}}</span>
        {{/each}}
      </div>
    </div>
  {{/each}}
  
    
</div>
